<!DOCTYPE html>
<html lang="en">
  <!DOCTYPE html>
  <html lang="en">
  <head>
      <!-- Metadata and settings for the webpage -->
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Soaring Skies: Australia's Global Connections</title>
      
      <!-- Include Vega and Vega-Lite libraries for creating interactive data visualizations -->
      <script src="https://cdn.jsdelivr.net/npm/vega@5.30.0"></script>
      <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.20.1"></script>
      <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.26.0"></script>
      
      <!-- Include Google Fonts for typography. Here, 'Roboto' font is used -->
      <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
      
      <!-- Inline CSS styling for layout and visual design -->
      <style>
          /* Basic styling for the body to set font family and background colors */
          body {
              font-family: 'Roboto', Arial, sans-serif;
              margin: 0;
              padding: 0;
              background: linear-gradient(135deg, #e0f7fa, #fcfbb3); /* Light blue gradient background */
              color: #333; /* Dark gray text color */
          }
  
          /* Wrapper around the main content to ensure consistent padding and centering */
          .wrapper {
              max-width: 1200px; /* Maximum width of content */
              margin: 0 auto; /* Center the content */
              padding: 20px; /* Add padding around content */
          }
  
          /* Container to structure visualization and text side-by-side with visual styling */
          .container {
              display: flex; /* Flexbox layout for side-by-side alignment */
              justify-content: space-between; /* Even spacing between elements */
              margin-bottom: 40px; /* Space between containers */
              background-color: rgba(255, 255, 255, 0.9); /* Slightly transparent white background */
              border-radius: 15px; /* Rounded corners for smooth design */
              box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1); /* Subtle shadow for depth */
              overflow: hidden; /* Hide content that overflows outside the container */
              transition: transform 0.3s ease; /* Animation effect on hover */
          }
  
          /* Container hover effect to slightly lift it on hover */
          .container:hover {
              transform: translateY(-5px); /* Moves the container 5px up on hover */
          }
  
          /* Visualization area inside each container */
          .visualization {
              flex: 1; /* Take up all available space */
              text-align: center; /* Center any text inside the visualization */
              padding: 20px; /* Padding around the visualization content */
          }
  
          /* Text area inside each container */
          .text {
              flex: 1; /* Take up all available space */
              padding: 30px; /* Padding around the text content */
              background-color: #ebf9ff; /* Light blue background for text area */
              display: flex; /* Flexbox for centering content */
              align-items: center; /* Vertically center text */
              justify-content: center; /* Horizontally center text */
              border-radius: 0 15px 15px 0; /* Rounded corners on the right side */
          }
  
          /* Styling for the main heading (title) of the page */
          .main-heading {
              width: 100%; /* Full width */
              background: linear-gradient(45deg, #0077CC, #00B4DB); /* Blue gradient background */
              color: white; /* White text color */
              padding: 30px 0; /* Padding around the heading */
              text-align: center; /* Center-align the text */
              font-size: 36px; /* Larger font size for prominence */
              margin-bottom: 30px; /* Space below the heading */
              border-radius: 15px; /* Rounded corners */
              text-shadow: 2px 2px 4px rgba(0,0,0,0.3); /* Slight shadow under the text */
              letter-spacing: 2px; /* Increase spacing between letters */
          }
  
          /* Styling for subheadings in each section */
          .sub-heading {
              font-size: 24px; /* Larger font size for emphasis */
              color: #0077CC; /* Dark blue color for subheading */
              margin-bottom: 15px; /* Space below the subheading */
              font-weight: 700; /* Bold text */
          }
  
          /* General paragraph styling for all text */
          p {
              line-height: 1.6; /* Spacing between lines */
              font-size: 16px; /* Font size */
          }
  
          /* Animated airplane icon near the main heading */
          .plane-icon {
              font-size: 40px; /* Large icon size */
              margin-right: 10px; /* Space to the right of the icon */
              animation: fly 5s infinite linear; /* Infinite animation of flying */
          }
  
          /* Keyframes for the airplane flying animation */
          @keyframes fly {
              0% { transform: translateX(-100%) translateY(0); } /* Starts off-screen on the left */
              50% { transform: translateX(100%) translateY(-20px); } /* Moves to the right while slightly rising */
              100% { transform: translateX(-100%) translateY(0); } /* Returns to the starting position */
          }
  

  
          /* Metadata section at the bottom of the page */
          .metadata {
              text-align: center; /* Center align the text */
              font-size: 12px; /* Smaller font size */
              color: #666; /* Gray color for text */
              margin-top: 20px; /* Space above the metadata section */
              padding: 10px; /* Padding inside the metadata section */
              background-color: rgba(255, 255, 255, 0.7); /* Slightly transparent white background */
              border-radius: 5px; /* Rounded corners */
              display: block; /* Ensures metadata takes up a block-level space */
              width: 100%; /* Full width */
              position: relative; /* Ensures proper positioning within its container */
              z-index: 1; /* Ensures metadata is layered above other elements */
          }
      </style>
  
      <!-- Author and copyright information for the webpage -->
      <meta name="author" content="Nipunaka Fonseka">
      <meta name="copyright" content="© 2024 Nipunaka Fonseka">
  </head>
  
  <body>
    <!-- Wrapper around the entire content to center it and apply consistent spacing -->
    <div class="wrapper">
        
        <!-- Main heading section with an animated plane icon and the title -->
        <div class="main-heading">
            <span class="plane-icon">✈️</span> <!-- Animated plane icon flying next to the title -->
            Soaring Skies: Australia's Global Connections
        </div>
        
        <!-- First container: A world map visualization and its accompanying text -->
        <div class="container">
            <!-- Visualization area where the Vega-Lite map visualization will be embedded (id="mapVis") -->
            <div class="visualization" id="mapVis"></div>
            
            <!-- Text section explaining the map visualization -->
            <div class="text">
                <div>
                    <h2 class="sub-heading">Global Flight Network</h2> <!-- Subheading for this section -->
                    <p>
                        Explore the vast network of international flights connecting Australia to the world.
                        Select different airlines to visualize their unique global footprint and discover the
                        reach of each carrier.
                    </p> <!-- Description explaining the purpose of the visualization -->
                </div>
            </div>
        </div>

        <!-- Second container: A  visualization and its accompanying text -->
        <div class="container">
            <!-- Text section explaining the -->
            <div class="text">
                <div>
                    <h2 class="sub-heading">City-to-City Connections</h2> <!-- Subheading for this section -->
                    <p>
                        This diagram unveils the intricate web of flights linking Australian cities
                        to international destinations. Witness the flow of air traffic and understand the 
                        pivotal role each airline plays in connecting continents.
                    </p> <!-- Description explaining the purpose of the  -->
                </div>
            </div>
            
            <!-- Visualization area where the Vega-Lite  will be embedded (id="sankeyVis") -->
            <div class="visualization" id="sankeyVis"></div>
        </div>

        <!-- Third container: A stacked bar chart visualization and its accompanying text -->
        <div class="container">
            <!-- Visualization area where the Vega-Lite stacked bar chart will be embedded (id="stackVis") -->
            <div class="visualization" id="stackVis"></div>
            
            <!-- Text section explaining the stacked bar chart -->
            <div class="text">
                <div>
                    <h2 class="sub-heading">Service Region Trends</h2> <!-- Subheading for this section -->
                    <p>
                        Delve into the dynamic landscape of airline operations with this stacked bar chart.
                        It showcases the evolution of flight numbers across various service regions, offering
                        insights into market dominance and expansion strategies over the years.
                    </p> <!-- Description explaining the purpose of the stacked bar chart -->
                </div>
            </div>
        </div>

        <!-- Fourth container: A scatter plot visualization and its accompanying text -->
        <div class="container">
            <!-- Text section explaining the scatter plot -->
            <div class="text">
                <div>
                    <h2 class="sub-heading">Fleet Capacity Insights</h2> <!-- Subheading for this section -->
                    <p>
                        Uncover the relationship between aircraft capacity and flight frequency in this scatter plot.
                        Gain valuable insights into how airlines optimize their fleet, balancing between high-capacity 
                        planes and flight frequency to meet passenger demands.
                    </p> <!-- Description explaining the purpose of the scatter plot -->
                </div>
            </div>

            <!-- Visualization area where the Vega-Lite scatter plot will be embedded (id="scatterVis") -->
            <div class="visualization" id="scatterVis"></div>
        </div>
    </div>

    <!-- Additional wrapper for the metadata section at the bottom of the page -->
    <div class="wrapper">
      
        <!-- Metadata section providing author information and data source credits -->
        <div class="metadata">
            <p>© 2024 Nipunaka Fonseka. All rights reserved.</p> <!-- Copyright information -->
            <p>Data source: Australian Government Department of Infrastructure, Transport, Regional Development and Communications</p> <!-- Data source credits -->
        </div>
    </div>

  <!-- Embedding Vega-Lite specifications -->
  <script>
    // Vega specifications for each visualization as needed
    // Embedding a Vega-Lite visualization into the HTML element with id="mapVis"
vegaEmbed('#mapVis', {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json", // Defining the Vega-Lite schema version
  "width": 800, // Width of the map visualization
  "height": 500, // Height of the map visualization
  "background": "#b3e5fc", // Light blue background color for the map
  "projection": {"type": "equalEarth"}, // Map projection type, using "equalEarth" for realistic representation

  // Creating a parameter for selecting an airline to filter data
  "params": [
    {
      "name": "airlineSelector", // Name of the parameter
      "value": "British Airways", // Default selected airline
      "bind": { // Dropdown selector to change the airline
        "input": "select", // Creates a dropdown
        "options": [ // List of airline options for the user to select from
          "Qantas Airways",
          "Cathay Pacific Airways",
          "Garuda Indonesia",
          "Jetstar",
          "Air New Zealand",
          "Japan Airlines",
          "Korean Air",
          "Singapore Airlines",
          "British Airways",
          "Air China",
          "Emirates",
          "Malaysia Airlines"
        ],
        "name": "Select Airline: " // Label shown next to the dropdown selector
      }
    }
  ],

  // Multiple layers of the visualization for different components
  "layer": [
    // Layer 1: Graticule (lines of latitude and longitude) for the map background
    {
      "data": {"graticule": {}}, // Data source for graticule lines
      "mark": {"type": "geoshape", "stroke": "white", "strokeWidth": 0.5} // Styling for graticule lines
    },
    // Layer 2: Countries as geoshapes
    {
      "data": {
        "url": "https://vega.github.io/vega-datasets/data/world-110m.json", // TopoJSON data for world map
        "format": {"type": "topojson", "feature": "countries"} // Specify that the data is in TopoJSON format
      },
      "mark": {
        "type": "geoshape", // Mark type as geoshape to create country borders
        "fill": "#fff9c4", // Yellowish color fill for countries
        "stroke": "#b2b2b2", // Light gray borders for country boundaries
        "strokeWidth": 1 // Border thickness for country outlines
      }
    },
    // Layer 3: Airline flight paths represented as lines between cities
    {
      "data": {
        "url": "https://raw.githubusercontent.com/nipunakaf16/dataset-for-viz/main/Fully_Cleaned_International_Airline_Activity_Data.csv" // Dataset with flight data
      },
      "transform": [{"filter": "datum.Airline == airlineSelector"}], // Filters flight data by the selected airline
      "mark": {"type": "line", "strokeWidth": 2, "opacity": 0.8}, // Line styling for flight paths
      "encoding": {
        "longitude": {"field": "AUS_City_Long", "type": "quantitative"}, // Longitude of departure (Australia)
        "latitude": {"field": "AUS_City_Lat", "type": "quantitative"}, // Latitude of departure (Australia)
        "longitude2": {"field": "INT_City_Long", "type": "quantitative"}, // Longitude of destination (International city)
        "latitude2": {"field": "INT_City_Lat", "type": "quantitative"}, // Latitude of destination (International city)
        "color": {
          "field": "International_City", // Use destination city as color encoding
          "type": "nominal", // Nominal (categorical) color encoding
          "title": "Destination City", // Tooltip title
          "scale": {"scheme": "category20"} // Color scheme using 20 distinct colors
        },
        "tooltip": [ // Tooltip configuration for flight details
          {
            "field": "Australian_City", // Show departure city in tooltip
            "type": "nominal",
            "title": "Australian City"
          },
          {
            "field": "International_City", // Show destination city in tooltip
            "type": "nominal",
            "title": "Destination City"
          },
          {
            "field": "All_Flights", // Show number of flights in tooltip
            "type": "quantitative",
            "title": "Number of Flights"
          }
        ]
      }
    },
    // Layer 4: Departure cities in Australia as red circles
    {
      "data": {
        "url": "https://raw.githubusercontent.com/nipunakaf16/dataset-for-viz/main/Fully_Cleaned_International_Airline_Activity_Data.csv" // Same flight dataset
      },
      "transform": [
        {"filter": "datum.Airline == airlineSelector"}, // Filter by selected airline
        {
          "aggregate": [{"op": "count", "as": "city_count"}], // Count the number of flights per Australian city
          "groupby": ["Australian_City", "AUS_City_Long", "AUS_City_Lat"] // Group by Australian city coordinates
        }
      ],
      "mark": {"type": "circle", "size": 30, "color": "red"}, // Styling for the red circle marks
      "encoding": {
        "longitude": {"field": "AUS_City_Long", "type": "quantitative"}, // Longitude of Australian city
        "latitude": {"field": "AUS_City_Lat", "type": "quantitative"}, // Latitude of Australian city
        "tooltip": [
          {
            "field": "Australian_City", // Tooltip for the name of the Australian city
            "type": "nominal",
            "title": "Departure City"
          },
          {
            "field": "city_count", // Tooltip for the number of flights from that city
            "type": "quantitative",
            "title": "Number of Flights"
          }
        ]
      }
    },
    // Layer 5: Destination cities as blue circles
    {
      "data": {
        "url": "https://raw.githubusercontent.com/nipunakaf16/dataset-for-viz/main/Fully_Cleaned_International_Airline_Activity_Data.csv" // Same flight dataset
      },
      "transform": [
        {"filter": "datum.Airline == airlineSelector"}, // Filter by selected airline
        {
          "aggregate": [{"op": "count", "as": "city_count"}], // Count the number of flights per international city
          "groupby": ["International_City", "INT_City_Long", "INT_City_Lat"] // Group by international city coordinates
        }
      ],
      "mark": {"type": "circle", "size": 30, "color": "blue"}, // Styling for the blue circle marks
      "encoding": {
        "longitude": {"field": "INT_City_Long", "type": "quantitative"}, // Longitude of international city
        "latitude": {"field": "INT_City_Lat", "type": "quantitative"}, // Latitude of international city
        "tooltip": [
          {
            "field": "International_City", // Tooltip for the name of the international city
            "type": "nominal",
            "title": "Arrival City"
          },
          {
            "field": "city_count", // Tooltip for the number of flights to that city
            "type": "quantitative",
            "title": "Number of Flights"
          }
        ]
      }
    }
  ],

  // Configuration for the visualization's view and transitions
  "config": {
    "view": {"continuousWidth": 800, "continuousHeight": 500}, // Fixed size for the map view
    "transition": {"duration": 200000} // Transition effect duration (in milliseconds)
  }
});

    // Embedding a Vega-Lite Sankey diagram into the HTML element with id="sankeyVis"
vegaEmbed('#sankeyVis', {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json", // Defining the Vega-Lite schema version
  "width": 800, // Width of the Sankey diagram
  "height": 600, // Height of the Sankey diagram

  // Dropdown selector for selecting an airline
  "params": [
    {
      "name": "airlineSelection", // Name of the parameter
      "value": "Air New Zealand", // Default value for airline selection
      "bind": { // Dropdown selector settings
        "input": "select", // Input type is a dropdown
        "options": [ // Dropdown options representing airlines
          "All Airlines",
          "Qantas Airways",
          "Cathay Pacific Airways",
          "Garuda Indonesia",
          "Jetstar",
          "Air New Zealand",
          "Japan Airlines",
          "Korean Air",
          "Singapore Airlines",
          "British Airways",
          "Air China",
          "Emirates",
          "Malaysia Airlines"
        ],
        "name": "Select Airline: " // Label next to the dropdown
      }
    }
  ],

  // The Sankey diagram consists of multiple layers
  "layer": [
    // Layer 1: Represent Australian departure cities as circles
    {
      "data": {
        "url": "https://raw.githubusercontent.com/nipunakaf16/dataset-for-viz/main/Fully_Cleaned_International_Airline_Activity_Data.csv" // Flight dataset
      },
      "transform": [
        // Filter flights based on the selected airline or show all airlines
        {
          "filter": "(airlineSelection == 'All Airlines' && (datum.Airline == 'Qantas Airways' || datum.Airline == 'Cathay Pacific Airways' || datum.Airline == 'Garuda Indonesia' || datum.Airline == 'jetstar' || datum.Airline == 'Air New Zealand' || datum.Airline == 'Japan Airlines' || datum.Airline == 'Korean Air' || datum.Airline == 'Singapore Airlines' || datum.Airline == 'British Airways' || datum.Airline == 'Air China' || datum.Airline == 'Emirates' || datum.Airline == 'Malaysia Airlines')) || datum.Airline == airlineSelection"
        }
      ],
      "mark": {"type": "circle", "size": 150}, // Represent each Australian city as a large circle
      "encoding": {
        "x": {"value": 100}, // Fixed x-position for departure cities on the left side
        "y": {"field": "Australian_City", "type": "nominal", "axis": null}, // y-position based on city names
        "color": {"value": "#1f77b4"}, // Blue color for the departure city circles
        "tooltip": [
          {"field": "Australian_City", "type": "nominal", "title": "From"} // Tooltip showing the departure city name
        ]
      }
    },

    // Layer 2: Represent international destination cities as circles
    {
      "data": {
        "url": "https://raw.githubusercontent.com/nipunakaf16/dataset-for-viz/main/Fully_Cleaned_International_Airline_Activity_Data.csv" // Same dataset for flight information
      },
      "transform": [
        // Similar filter logic as Layer 1 to select based on the airline or show all
        {
          "filter": "(airlineSelection == 'All Airlines' && (datum.Airline == 'Qantas Airways' || datum.Airline == 'Cathay Pacific Airways' || datum.Airline == 'Garuda Indonesia' || datum.Airline == 'jetstar' || datum.Airline == 'Air New Zealand' || datum.Airline == 'Japan Airlines' || datum.Airline == 'Korean Air' || datum.Airline == 'Singapore Airlines' || datum.Airline == 'British Airways' || datum.Airline == 'Air China' || datum.Airline == 'Emirates' || datum.Airline == 'Malaysia Airlines')) || datum.Airline == airlineSelection"
        }
      ],
      "mark": {"type": "circle", "size": 150}, // Represent international cities as large circles
      "encoding": {
        "x": {"value": 600}, // Fixed x-position for destination cities on the right side
        "y": {"field": "International_City", "type": "nominal", "axis": null}, // y-position based on city names
        "color": {"value": "#ff7f0e"}, // Orange color for the destination city circles
        "tooltip": [
          {"field": "International_City", "type": "nominal", "title": "To"} // Tooltip showing the destination city name
        ]
      }
    },

    // Layer 3: Draw rules (lines) representing flight paths between departure and destination cities
    {
      "data": {
        "url": "https://raw.githubusercontent.com/nipunakaf16/dataset-for-viz/main/Fully_Cleaned_International_Airline_Activity_Data.csv" // Same dataset
      },
      "transform": [
        // Filter based on the selected airline or show all airlines
        {
          "filter": "(airlineSelection == 'All Airlines' && (datum.Airline == 'Qantas Airways' || datum.Airline == 'Cathay Pacific Airways' || datum.Airline == 'Garuda Indonesia' || datum.Airline == 'jetstar' || datum.Airline == 'Air New Zealand' || datum.Airline == 'Japan Airlines' || datum.Airline == 'Korean Air' || datum.Airline == 'Singapore Airlines' || datum.Airline == 'British Airways' || datum.Airline == 'Air China' || datum.Airline == 'Emirates' || datum.Airline == 'Malaysia Airlines')) || datum.Airline == airlineSelection"
        },
        {"calculate": "datum.All_Flights * 20", "as": "Flight_Thickness"} // Calculate line thickness based on the number of flights
      ],
      "mark": {"type": "rule", "tooltip": true}, // Lines representing the flight paths
      "encoding": {
        "x": {"value": 100}, // Start position (left) for departure cities
        "y": {"field": "Australian_City", "type": "nominal"}, // y-position for departure cities
        "x2": {"value": 600}, // End position (right) for destination cities
        "y2": {"field": "International_City", "type": "nominal"}, // y-position for destination cities
        "color": {"field": "Airline", "type": "nominal"}, // Color coding for each airline
        "strokeWidth": {
          "field": "Flight_Thickness", // Line thickness based on the number of flights
          "type": "quantitative",
          "scale": {"domain": [0, 50000], "range": [1, 20]}, // Scale the thickness
          "legend": {"title": "Number of Flights"} // Add a legend for line thickness
        },
        "tooltip": [ // Tooltips to show additional flight information
          {"field": "Australian_City", "type": "nominal", "title": "From"},
          {"field": "International_City", "type": "nominal", "title": "To"},
          {"field": "All_Flights", "type": "quantitative", "title": "Number of Flights"},
          {"field": "Airline", "type": "nominal", "title": "Airline"}
        ]
      }
    },

    // Layer 4: Add text labels for Australian cities
    {
      "data": {
        "url": "https://raw.githubusercontent.com/nipunakaf16/dataset-for-viz/main/Fully_Cleaned_International_Airline_Activity_Data.csv" // Same dataset
      },
      "transform": [
        // Similar filter to match the data with airline selection
        {
          "filter": "(airlineSelection == 'All Airlines' && (datum.Airline == 'Qantas Airways' || datum.Airline == 'Cathay Pacific Airways' || datum.Airline == 'Garuda Indonesia' || datum.Airline == 'jetstar' || datum.Airline == 'Air New Zealand' || datum.Airline == 'Japan Airlines' || datum.Airline == 'Korean Air' || datum.Airline == 'Singapore Airlines' || datum.Airline == 'British Airways' || datum.Airline == 'Air China' || datum.Airline == 'Emirates' || datum.Airline == 'Malaysia Airlines')) || datum.Airline == airlineSelection"
        }
      ],
      "mark": {"type": "text", "align": "right", "dx": -10, "dy": 0}, // Text mark for city names
      "encoding": {
        "x": {"value": 100}, // Position on the left side
        "y": {"field": "Australian_City", "type": "nominal"}, // Align with the corresponding city circle
        "text": {"field": "Australian_City", "type": "nominal"}, // Display the city name
        "color": {"value": "black"} // Black color for the text
      }
    },

    // Layer 5: Add text labels for international destination cities
    {
      "data": {
        "url": "https://raw.githubusercontent.com/nipunakaf16/dataset-for-viz/main/Fully_Cleaned_International_Airline_Activity_Data.csv" // Same dataset
      },
      "transform": [
        {
          "filter": "(airlineSelection == 'All Airlines' && (datum.Airline == 'Qantas Airways' || datum.Airline == 'Cathay Pacific Airways' || datum.Airline == 'Garuda Indonesia' || datum.Airline == 'jetstar' || datum.Airline == 'Air New Zealand' || datum.Airline == 'Japan Airlines' || datum.Airline == 'Korean Air' || datum.Airline == 'Singapore Airlines' || datum.Airline == 'British Airways' || datum.Airline == 'Air China' || datum.Airline == 'Emirates' || datum.Airline == 'Malaysia Airlines')) || datum.Airline == airlineSelection"
        }
      ],
      "mark": {"type": "text", "align": "left", "dx": 10, "dy": 0}, // Text mark for city names
      "encoding": {
        "x": {"value": 600}, // Position on the right side
        "y": {"field": "International_City", "type": "nominal"}, // Align with the corresponding city circle
        "text": {"field": "International_City", "type": "nominal"}, // Display the city name
        "color": {"value": "black"} // Black color for the text
      }
    }
  ],

  "config": {} // Default configuration
});

    // Embedding a Vega-Lite stacked bar chart into the HTML element with id="stackVis"
// Embedding a Vega-Lite stacked bar chart into the HTML element with id="stackVis"
vegaEmbed('#stackVis', {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json", // Defining the Vega-Lite schema version
  "width": 600, // Width of the bar chart
  "height": 400, // Height of the bar chart

  // Data source for the chart (CSV file containing flight data)
  "data": {
    "url": "https://raw.githubusercontent.com/nipunakaf16/dataset-for-viz/main/Fully_Cleaned_International_Airline_Activity_Data.csv"
  },

  // Parameter for selecting a year dynamically using a range slider
  "params": [
    {
      "name": "yearSelection", // Name of the parameter (year selector)
      "value": 2003, // Default value for the year
      "bind": {
        "input": "range", // Input type is a range slider
        "min": 2003, // Minimum year allowed (start of the dataset)
        "max": 2022, // Maximum year allowed (end of the dataset)
        "step": 1, // Increment by 1 year at a time
        "name": "Select Year: " // Label displayed next to the slider
      }
    }
  ],

  // Data transformation: filter data based on the selected year and specific airlines
  "transform": [
    {"filter": "datum.Year == yearSelection"}, // Filter the data to show only for the selected year
    {
      "filter": "datum.Airline == 'Qantas Airways' || datum.Airline == 'Cathay Pacific Airways' || datum.Airline == 'Garuda Indonesia' || datum.Airline == 'jetstar' || datum.Airline == 'Air New Zealand' || datum.Airline == 'Japan Airlines' || datum.Airline == 'Korean Air' || datum.Airline == 'Singapore Airlines' || datum.Airline == 'British Airways' || datum.Airline == 'Air China' || datum.Airline == 'Emirates' || datum.Airline == 'Malaysia Airlines'" 
    } // Filter to show flights only for the listed airlines
  ],

  // Layered visualization (combining bars and text labels)
  "layer": [
    // Layer 1: The bar chart itself
    {
      "mark": "bar", // Mark type is a bar
      "encoding": {
        // x-axis: service regions (nominal data, categories)
        "x": {
          "field": "Service_Region", // The service region (categorical)
          "type": "nominal", // Nominal data type (categories)
          "axis": {"labelAngle": -45, "title": "Service Region"} // Rotate labels and add title
        },
        // y-axis: sum of total flights (quantitative data)
        "y": {
          "aggregate": "sum", // Sum the number of flights for each region
          "field": "All_Flights", // The number of flights
          "type": "quantitative", // Quantitative data type (numerical)
          "title": "Total Flights" // y-axis title
        },
        // Color encoding: differentiate airlines by color
        "color": {
          "field": "Airline", // Use airline as the color key
          "type": "nominal", // Nominal (categorical) data type
          "scale": {
            "domain": [ // List of airline names
              "Qantas Airways",
              "Cathay Pacific Airways",
              "Garuda Indonesia",
              "Jetstar",
              "Air New Zealand",
              "Japan Airlines",
              "Korean Air",
              "Singapore Airlines",
              "British Airways",
              "Air China",
              "Emirates",
              "Malaysia Airlines"
            ],
            "range": [ // Custom color palette for the airlines
              "#1f77b4", // Qantas Airways
              "#ff7f0e", // Cathay Pacific Airways
              "#2ca02c", // Garuda Indonesia
              "#9467bd", // Jetstar
              "#8c564b", // Air New Zealand
              "#e377c2", // Japan Airlines
              "#17becf", // Korean Air
              "#bcbd22", // Singapore Airlines
              "#7f7f7f", // British Airways
              "#ff69b4", // Air China
              "#ffbb78", // Emirates
              "#98df8a"  // Malaysia Airlines
            ]
          }
        },
        // Tooltip encoding to show additional information on hover
        "tooltip": [
          {"field": "Airline", "type": "nominal", "title": "Airline"}, // Show airline name
          {"field": "Service_Region", "type": "nominal", "title": "Service Region"}, // Show service region
          {
            "field": "All_Flights", // Show the total number of flights
            "type": "quantitative",
            "aggregate": "sum",
            "title": "Total Flights"
          },
          {"field": "Year", "type": "quantitative", "title": "Year"} // Show the selected year
        ]
      }
    },

    // Layer 2: Add text labels on top of the bars to show the total number of flights
    {
      "mark": {
        "type": "text", // Mark type is text
        "align": "center", // Center-align the text
        "baseline": "bottom", // Position text at the bottom of the bar
        "dy": -5, // Offset the text slightly above the bar
        "fontSize": 10, // Set font size to 10 for clarity
        "fontWeight": "bold" // Make the text bold for emphasis
      },
      "encoding": {
        // x-axis: same as the bars, based on service region
        "x": {"field": "Service_Region", "type": "nominal"},
        // y-axis: position the text based on the sum of flights
        "y": {"aggregate": "sum", "field": "All_Flights", "type": "quantitative"},
        // Text content: show the sum of flights with formatting (commas for large numbers)
        "text": {"aggregate": "sum", "field": "All_Flights", "type": "quantitative", "format": ","},
        // Text color is set to black for contrast
        "color": {"value": "black"}
      }
    }
  ],

  // Additional configuration options for the visualization
  "config": {
    "view": {"stroke": null}, // Remove borders around the chart
    "axis": {"grid": false} // Disable gridlines for a cleaner look
  }
});


    // Embedding a Vega-Lite scatter plot into the HTML element with id="scatterVis"
vegaEmbed('#scatterVis', {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json", // Vega-Lite schema version
  "width": 600, // Width of the scatter plot
  "height": 400, // Height of the scatter plot

  // Data source for the chart (CSV file containing flight data)
  "data": {
    "url": "https://raw.githubusercontent.com/nipunakaf16/dataset-for-viz/main/Fully_Cleaned_International_Airline_Activity_Data.csv"
  },

  // Parameters for selecting the year and the airline dynamically
  "params": [
    {
      "name": "yearSelection", // Parameter for year selection
      "value": 2022, // Default year value
      "bind": {
        "input": "range", // Input type is a range slider
        "min": 2003, // Minimum year
        "max": 2022, // Maximum year
        "step": 1, // Increment step by 1 year
        "name": "Select Year: " // Label for the year slider
      }
    },
    {
      "name": "airlineSelection", // Parameter for airline selection
      "value": ["Jetstar"], // Default airline
      "bind": {
        "input": "select", // Input type is a dropdown selector
        "options": [ // Available airline options
          "Jetstar", "Qantas Airways", "Cathay Pacific Airways", 
          "Garuda Indonesia", "Air New Zealand", "Japan Airlines", 
          "Korean Air", "Singapore Airlines", "British Airways", 
          "Emirates", "Malaysia Airlines"
        ],
        "labels": [ // Labels for the dropdown options (matches options)
          "Jetstar", "Qantas Airways", "Cathay Pacific Airways", 
          "Garuda Indonesia", "Air New Zealand", "Japan Airlines", 
          "Korean Air", "Singapore Airlines", "British Airways", 
          "Emirates", "Malaysia Airlines"
        ],
        "name": "Select Airline: " // Label for the airline dropdown
      }
    }
  ],

  // Data transformation to filter by year and airline
  "transform": [
    {"filter": "datum.Year == yearSelection"}, // Filter the data by the selected year
    {"filter": "indexof(airlineSelection, datum.Airline) >= 0"} // Filter the data by the selected airline
  ],

  // Mark type is a point for the scatter plot
  "mark": {"type": "point", "opacity": 0.7}, // Points with some transparency (opacity)

  // Encoding the data for visualization
  "encoding": {
    // x-axis encoding for Max_Seats (max number of seats)
    "x": {
      "field": "Max_Seats", // Max number of seats in the flights
      "type": "quantitative", // Quantitative (numerical) data
      "title": "Max Number of Seats", // Title for the x-axis
      "scale": {"zero": false} // Do not force the x-axis to start from 0
    },

    // y-axis encoding for All_Flights (number of flights)
    "y": {
      "field": "All_Flights", // Total number of flights
      "type": "quantitative", // Quantitative (numerical) data
      "title": "Number of Flights", // Title for the y-axis
      "scale": {"zero": false} // Do not force the y-axis to start from 0
    },

    // Color encoding to differentiate airlines
    "color": {
      "field": "Airline", // Color represents the airline
      "type": "nominal", // Nominal (categorical) data
      "scale": {"scheme": "category20"}, // Color scheme with 20 distinct colors
      "legend": {"orient": "right", "title": null} // Position the legend on the right, no title for the legend
    },

    // Size encoding to scale points based on the Max_Seats field
    "size": {
      "field": "Max_Seats", // Use the max number of seats to size the points
      "type": "quantitative", // Quantitative (numerical) data
      "title": "Max Number of Seats", // Title for the size legend
      "scale": {"range": [20, 200]} // Size range for the points
    },

    // Tooltip encoding to display details on hover
    "tooltip": [
      {"field": "Airline", "type": "nominal"}, // Show the airline name
      {"field": "Max_Seats", "type": "quantitative", "title": "Max Number of Seats"}, // Show the max seats
      {"field": "All_Flights", "type": "quantitative", "title": "Number of Flights"}, // Show the number of flights
      {"field": "Year", "type": "quantitative"} // Show the selected year
    ]
  },

  // Additional configuration for the visualization
  "config": {
    "view": {"stroke": null} // Remove borders around the visualization
  }
});

  </script>
</body>
</html>
